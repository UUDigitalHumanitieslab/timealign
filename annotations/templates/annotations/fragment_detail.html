{% extends "base/base.html" %}

{% load bootstrap3 %}

{% block content %}
<style>
.selected {
    background-color: lightgreen;
}

.in-dialogue {
    font-style: italic;
}
</style>

<div class="container">
    <h1>Fragment overview</h1>

    <h2>Source</h2>
    <h3 data-pk="{{ fragment.pk }}">
        {{ fragment.language.title }}
        <span class="label label-default pull-right">{{ fragment.document.title }}</span>
        <span class="label label-primary pull-right">{{ fragment.tense|default:"Perfect" }}</span>
        {% if fragment.document.corpus.check_structure %}
        <span class="label label-warning pull-right">{{ fragment.get_formal_structure_display }}</span>
        <span class="label label-primary pull-right">{{ fragment.get_sentence_function_display }}</span>
        {% endif %}
    </h3>
    {% include "annotations/_sentences.html" with sentences=fragment.sentence_set.all tooltips=1 %}

    <h2>Translations</h2>
    {% for language, annotation in fragment.get_annotations %}
    {% if forloop.counter0|divisibleby:2 %}<div class="row">{% endif %}
        <div class="col-md-6 {% if not annotation %} text-muted {% endif %}">
            <h3 data-pk="{{ annotation.pk }}">
                {{ language }}
                <span class="label label-primary pull-right">{{ annotation.label }}</span>
                {% if fragment.document.corpus.check_structure and annotation.is_not_same_structure%}
                <span class="label label-danger pull-right">{% if fragment.formal_structure == 1 %}dialogue{% else %}narration{% endif %}</span>
                {% endif %}
            </h3>
            {% if annotation %}
                {% include "annotations/_sentences.html" with sentences=annotation.alignment.translated_fragment.sentence_set.all tooltips=1 annotated_words=annotation.words.all %}
            {% else %}
            No annotation available.
            {% endif %}
        </div>
    {% if forloop.counter|divisibleby:2 %}</div>{% endif %}
    {% endfor %}
</div>

<script>
$(function() {
    $(".tooltiptext").hide();

    $(".alignment span").each(function() {
        $(this).qtip({
            content: {
                text: $(this).next(".tooltiptext")
            }
        });
    });
});
</script>
{% endblock %}
